(window.webpackJsonp=window.webpackJsonp||[]).push([["bannerManager"],{"/5+W":function(n,e,t){"use strict";var a;t.d(e,"a",(function(){return a})),function(n){n[n.Top=0]="Top",n[n.Bottom=1]="Bottom"}(a||(a={}))},HBiX:function(n,e){},HfmA:function(n,e,t){"use strict";t.r(e),t.d(e,"BannerManager",(function(){return x})),t.d(e,"BannerManagerActions",(function(){return s.a})),t.d(e,"BannerManagerConnector",(function(){return m})),t.d(e,"BannerManagerReducer",(function(){return B})),t.d(e,"BannerPlacement",(function(){return a.a})),t.d(e,"ToolingInfo",(function(){return M}));var a=t("/5+W"),r=t("+viU"),i=t("HBiX"),s=t("tacz"),o=t("nyTL"),c=t("D57K"),h=t("KRKw"),d=t("s9+9"),u=t("9J8d"),b=t("lWIl"),p=t("yyfr");const l={inspect:n=>{const{children:e,state:t}=n;return{props:{bannerAction:t.bannerAction,bannerExperiences:e},missingChildren:[]}}};var g=t("WfnD");class m extends g.a{constructor(n,e,t,a,r,i,o){super(n,e,t,a,r,i,o),this.bannerAnimationId="bannerManagerAnimationID",this.bannersInfo={},this.bannersInstance={},this.bannersPriorityQueue=[],this.bannersPendingQueue=[],this.currentBannerId=null,this.noBanner=n=>{this.removeFromBannersPriorityQueue(n),this.showNextPendingBanner()},this.showBanner=(n,e,t)=>{if(!this.canShowBanner(n,e,t))return;this.currentBannerId=n,s.a.setBanner.getActionSender(this).send({bannerId:n,display:!0});const a=this.bannersInfo[n],r=a&&a.metadata&&a.metadata.height?a.metadata.height:"0",i=parseInt(r,10);s.a.updateBannerHeight.getActionSender(this).send(i);const o=document.getElementById(this.bannerAnimationId+"_"+n);o&&this.animateBanner(o,!0,1e3),"function"==typeof t&&t()},this.hideBanner=(n,e)=>{"function"==typeof e&&e(),s.a.setBanner.getActionSender(this).send({bannerId:n,display:!1}),s.a.updateBannerHeight.getActionSender(this).send(0);const t=document.getElementById(this.bannerAnimationId+"_"+n);t&&this.animateBanner(t,!1,1e3),setTimeout(()=>{this.currentBannerId=null,this.removeFromBannersPriorityQueue(n),this.showNextPendingBanner()},1e3)}}onComponentConnect(n){return Object(c.b)(this,void 0,void 0,(function*(){yield g.a.prototype.onComponentConnect.call(this),this.getCookieConsentStatus()===h.b.NotRequired&&(this.createBannersInfoMap(),this.createBannersPriorityQueue(),yield this.createBannersInstancesMap())}))}getCookieConsentStatus(){const n=u.a.getInstance();return new b.a(d.a.SharedState,"",n.rootReducer,new p.a,n.store,void 0,this.requestContext).getCurrentState().cookieConsentStatus}mapStateToProps(n){const e={config:this.config,children:this.bannersInstance,state:n},t=l.inspect(e),a=Object.assign(Object.assign({},t.props),this.telemetryTags);return a.bannerAnimationId=this.bannerAnimationId,a}createBannersInfoMap(){const n=this.config.children&&this.config.children.length;for(let e=0;e<n;e++){const n=this.config.children[e];this.bannersInfo[n.childExperienceConfigInfo.instanceId]=n}}createBannersPriorityQueue(){for(const n in this.bannersInfo){const e=this.bannersInfo[n],t=e.metadata&&e.metadata.priority?e.metadata.priority:1/0;this.bannersPriorityQueue.push({bannerId:n,priority:t})}this.bannersPriorityQueue.sort((function(n,e){return n.priority-e.priority}))}createBannersInstancesMap(){return Object(c.b)(this,void 0,void 0,(function*(){const n=[];for(const e in this.bannersInfo){const t=this.bannersInfo[e];this.bannersInstance[e]=null,n.push(t.childExperienceConfigInfo)}yield this.loadChildrenExperiences(n);for(const n in this.bannersInstance){const e=this.childMap.get(n);if(e){const t={bannerId:n,showBanner:this.showBanner,hideBanner:this.hideBanner,noBanner:this.noBanner};this.bannersInstance[n]=e.getNewComponentInstance(t)}}}))}animateBanner(n,e,t){n.style.transition="max-height "+t+"ms ease-out",n.style.maxHeight=e?"150px":"0px",setTimeout(()=>{n.style.transition="none",s.a.notifyBannerDidAnimate.getActionSender(this).send(e)},t)}showNextPendingBanner(){const n=this.bannersPendingQueue.length;if(!n)return;const e=this.bannersPriorityQueue[0].bannerId,t=[];let a=null;for(let r=0;r<n;r++)this.bannersPendingQueue[r].bannerId===e?a=this.bannersPendingQueue[r]:t.push(this.bannersPendingQueue[r]);this.bannersPendingQueue=t,a&&this.showBanner(a.bannerId,a.placement,a.callback)}removeFromBannersPriorityQueue(n){const e=[],t=this.bannersPriorityQueue.length;for(let a=0;a<t;a++)this.bannersPriorityQueue[a].bannerId!==n&&e.push(this.bannersPriorityQueue[a]);this.bannersPriorityQueue=e}canShowBanner(n,e,t){if(null===this.currentBannerId&&this.bannersPriorityQueue[0].bannerId===n)return!0;const a={bannerId:n,placement:e,callback:t};return this.bannersPendingQueue.push(a),!1}}var f=t("05Au");class B{reduce(n,e){if(!n)return{bannerAction:{bannerId:"",display:null}};if(!e)return n;let t,a=!1;return a=f.a.handleAction(e,s.a.notifyBannerDidAnimate,e=>{t=n}),a=f.a.handleAction(e,s.a.setBanner,e=>{t=Object.assign(Object.assign({},n),{bannerAction:e})}),a=f.a.handleAction(e,s.a.updateBannerHeight,e=>{t=Object.assign(Object.assign({},n),{bannerHeight:e})}),t||n}}const I={bannerManager:{"z-index":""+t("0fst").a.Overlay},bannerManagerContainer:{"max-height":"0px",overflow:"hidden"}};var y=t("5mwN"),C=t("ERkP"),P=t.n(C);class v extends y.a{constructor(){super(...arguments),this.handledProps=Object.assign(Object.assign({},y.b),{customField:void 0,experienceName:void 0,bannerAction:void 0,bannerAnimationId:void 0,bannerExperiences:void 0,managedClasses:void 0,requestContext:void 0,onExperienceMilestoneTimingUpdate:void 0})}render(){return super.render(),this.setupBanners(),P.a.createElement("div",Object.assign({className:this.generateClassNames(this.props.managedClasses.bannerManager),id:"bannerManager"},this.unhandledProps()),this.banners)}setupBanners(){const{bannerExperiences:n,managedClasses:e,bannerAction:t}=this.props;this.banners=[];for(const e in n){const t=n[e],a=P.a.createElement("div",{key:e,className:this.props.managedClasses.bannerManagerContainer,id:this.props.bannerAnimationId+"_"+e},t);this.banners.push(a)}}}v.defaultProps={experienceName:"BannerManager"};var A=t("RMFD");const x=Object(r.a)(I)(v),M={reactComponent:x,experienceConfigSchema:o.BannerManagerConfigSchema,defaultMockState:i.mockDefaultState,mockState:i.mockState,mockConfig:A.mockConfig,inspector:l.inspect}},RMFD:function(n,e){},nyTL:function(n,e){}}]);