(window.webpackJsonp=window.webpackJsonp||[]).push([["telemetry"],{C4R5:function(e,t,o){"use strict";o.d(t,"c",(function(){return f})),o.d(t,"e",(function(){return y})),o.d(t,"b",(function(){return u})),o.d(t,"a",(function(){return g})),o.d(t,"d",(function(){return P}));var i,n=o("D57K"),a=o("9J8d"),s=o("FaCY"),c=o("s9+9"),r=o("rvYQ"),d=o("Z3LZ");class l{constructor(e,t){this.onUpdateFollowedTopics=()=>{if(!this.connector)return this.onRouteUpdateCallback([]);const e=this.connector.getCurrentState(),t=e.followedTopicIds,o=e.topicMap,n=[];t&&o&&t.forEach(e=>{const t=o[e],a={path:f(t.canonicalName||t.name,e),display:t.name,experienceInfo:this.dynamicRouteExperienceInfo,context:{feedId:e},pivotId:e,dynamicPivotSource:i.TopicsData};n.push(a)}),this.onRouteUpdateCallback(n)},this.onRouteUpdateCallback=e,this.dynamicRouteExperienceInfo=t}getDynamicPivotsFromDataConnector(e){return Object(n.b)(this,void 0,void 0,(function*(){switch(e){case c.a.TopicData:yield this.getPivotsFromTopicData();break;case c.a.NavigationData:yield this.getPivotsFromNavigationData();break;default:return}}))}getPivotsFromTopicData(){return Object(n.b)(this,void 0,void 0,(function*(){yield Object(d.l)(),a.a.getInstance().rootReducer.getDataConnector(c.a.TopicData).then(e=>{this.connector=e,this.connector.getFollowedTopics(!1).then(()=>{this.onUpdateFollowedTopics()})}),s.a.followedTopics.registerObserver(this.onUpdateFollowedTopics),s.a.updateTopicFollowedState.registerObserver(this.onUpdateFollowedTopics)}))}getPivotsFromNavigationData(){return Object(n.b)(this,void 0,void 0,(function*(){if(this.connector=yield a.a.getInstance().rootReducer.getDataConnector(c.a.NavigationData),this.connector){const e=yield this.connector.getNavigationItems(r.b.HostPage.verticalKey,r.b.HostPage.categoryKey);this.onRouteUpdateCallback(this.mapNavigationItemsToDynamicRoutes(e))}else this.onRouteUpdateCallback([])}))}mapNavigationItemsToDynamicRoutes(e){return e.map(e=>({path:e.targetUrl,externalUrl:e.targetUrl,display:e.displayText,pivotId:e.categoryKey,dynamicPivotSource:i.NavigationData}))}}!function(e){e.NavigationData="NavigationDataAdapter",e.TopicsData="TopicsDataAdapter"}(i||(i={}));var u,p=o("b2pY"),h=o("dTwT");class m{constructor(e){this.staticRoutes=[],this.dynamicRoutes=[],this.onUpdateRoutesCallbacks=[],this.switchListeners=[],this.callSwitchListeners=e=>{if(!this.switchListeners.length)return;const t=this.getPivotSelectionInfoFromPath(e.state&&e.state.previousPath),o=this.getPivotSelectionInfoFromPath(e.pathname,e),i={newSelection:o,oldSelection:t};this.config.enableRememberedPivots&&h.a.setItem(w,o&&o.pivotId),this.switchListeners.sort((e,t)=>e.order-t.order);for(const e of this.switchListeners)e.callback(i)},e&&(e.enableLocaleFeedPrefix&&(m.enableLocaleFeedPrefix=!0),this.setRoutes(e)),p.a.listen(this.callSwitchListeners)}setRoutes(e){this.config=e,this.setStaticRoutes(),this.config.disableLoadingDynamicRoutes||this.setDynamicRoutes()}pushHistory(e,t,o,i){const n=p.a.location.pathname;p.a.push(f(e,t),{previousPath:n,context:o},i)}getStaticRoutes(){return this.staticRoutes}getDynamicRoutes(){return this.dynamicRoutes}getDynamicRoute(){return{path:f("interest"),experienceInfo:this.config.dynamicRouteExperienceInfo,pivotId:"oneriver.xfeed"}}isDynamicRoute(e){const t=r.b.CurrentMarket,o=m.enableLocaleFeedPrefix?`/${t}/feed/interest`:"/interest";return 0===e.indexOf(o)}getCurrentRoute(){const e=p.a.location.pathname,t=this.staticRoutes.find(t=>t.path===e);return t||(e.includes("/interest")?this.getDynamicRoute():null)}addDynamicRouteListener(e){this.onUpdateRoutesCallbacks.push(e)}addSwitchListener(e,t=v.AfterLoadContent){this.switchListeners.push({callback:e,order:t})}getRememberedPivot(){if(!this.config.enableRememberedPivots)return;const e=h.a.getItem(w);e&&this.config.staticRoutes.forEach(t=>{t.pivotId===e&&this.pushHistory(t.canonicalName)})}getPivotSelectionInfoFromPath(e,t){if(!e)return null;const o=this.config.staticRoutes.find(t=>f(t.canonicalName)===e);if(o)return{pivotId:o.pivotId,telemetryPageName:o.telemetryPageName,telemetryPivotCategory:o.telemetryPivotCategory,display:o.canonicalName};if(!this.isDynamicRoute(e))return null;const i=e.split("/"),n=m.enableLocaleFeedPrefix?2:0,a=t&&t.state&&t.state.context;return{telemetryPageName:"xfeed",telemetryPivotCategory:"news",pivotId:a&&t.state.context.feedId||i.length>=4+n&&i[3+n],display:a&&(t.state.context.display||t.state.context.query)||i.length>=3+n&&decodeURIComponent(i[2+n])}}setStaticRoutes(){const{staticRoutes:e}=this.config;e.forEach(e=>{const t={path:f(e.canonicalName)||e.externalUrl,externalUrl:e.externalUrl,experienceInfo:e.experienceInfo,queryParamOverrides:e.queryParamOverrides,display:e.canonicalName,pivotId:e.pivotId,context:e.context};this.staticRoutes.push(t)})}setDynamicRoutes(){return Object(n.b)(this,void 0,void 0,(function*(){const e=new l(this.onUpdateDynamicRoute.bind(this),this.config.dynamicRouteExperienceInfo);yield e.getDynamicPivotsFromDataConnector(this.config.dynamicRouteDataConnector)}))}onUpdateDynamicRoute(e){this.dynamicRoutes=e;for(const e of this.onUpdateRoutesCallbacks)e(this.dynamicRoutes)}}function f(e,t){if(m.enableLocaleFeedPrefix){const o=r.b.CurrentMarket;if(!e)return`/${o}/feed`;if(t)return`/${o}/feed/interest/${encodeURIComponent(e)}/${encodeURIComponent(t)}`;const i="/"===e[0]?e.slice(1):e;return g[i]?`/${o}/feed${g[i]}`:`/${o}/feed/${i}`}{if(!e)return"";if(t)return`/interest/${encodeURIComponent(e)}/${encodeURIComponent(t)}`;const o="/"===e[0]?e.slice(1):e;return g[o]||"/"+o}}function y(e){return!!(e&&e.oldSelection&&e.newSelection)&&(!(!e.oldSelection||!e.oldSelection.pivotId)&&!(!e.newSelection||!e.newSelection.pivotId))}m.enableLocaleFeedPrefix=!1,function(e){e.MyFeed="myFeed",e.Personalize="personalize",e.Saves="saves"}(u||(u={}));const g={myFeed:"/",personalize:"/personalize",interest:"/interest/*/:id",saves:"/personalize/saves"};var v;!function(e){e[e.Telemetry=0]="Telemetry",e[e.Monetization=1]="Monetization",e[e.LoadContent=2]="LoadContent",e[e.AfterLoadContent=3]="AfterLoadContent"}(v||(v={}));const w="selectedPivot";let R;const P=e=>R?(e&&R.setRoutes(e),R):(R=new m(e),R)},FaCY:function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));var i=o("G82u");class n{}n.followedTopics=new i.a("FollowedTopics"),n.followedTopicsFailed=new i.a("FollowedTopicsFailedSignature"),n.recommendedTopics=new i.a("RecommendedTopics"),n.recommendedTopicsFailed=new i.a("RecommendedTopicsFailed"),n.topic=new i.a("Topic"),n.topicFailed=new i.a("TopicsFailed"),n.topics=new i.a("Topics"),n.topicsFailed=new i.a("TopicsFailed"),n.topicGroup=new i.a("TopicGroup"),n.topicGroupFailed=new i.a("TopicGroupFailed"),n.updateTopicFollowedState=new i.a("UpdateTopicFollowedState"),n.updateTopicFollowedStateFailed=new i.a("UpdateTopicFollowedStateFailed")},YS0M:function(e,t,o){"use strict";o.r(t),o.d(t,"TelemetryDataConnector",(function(){return p})),o.d(t,"TelemetryDataReducer",(function(){return h})),o.d(t,"ToolingInfo",(function(){return m}));var i=o("1w6q"),n=o("9J8d"),a=o("u5KZ"),s=o("w0HK"),c=o("loKy"),r=o("s9+9");const d="tp";var l=o("HDSB"),u=o("C4R5");class p extends i.a{constructor(e,t,o,i,d,p,h){super(e,t,o,i,d,p,h);const m=Object(s.a)(),f=m.getSelectedPivot();if(f&&f.telemetryPivotCategory){let e;e.page.pivot=f.telemetryPivotCategory,a.a.updatePageMetadata(e)}if(Object(l.a)()){const e=n.a.getInstance().rootReducer.connector(r.a.SharedState);e&&e.getCurrentState().useHistory?Object(u.d)().addSwitchListener(this.onPivotSwitch,c.a.Telemetry):m.addSwitchListener(this.onPivotSwitch,c.a.Telemetry)}}onPivotSwitch(e){let t;const o=e.newSelection;if(o&&(a.a.addOrUpdateCustomProperty(d,o.display),t={feed:{id:o.pivotId,name:o.display,type:"xfeed"===o.telemetryPageName?"category filter":void 0},page:{content:{topic:o.display},pivot:""}},o.telemetryPivotCategory&&(t.page.pivot=o.telemetryPivotCategory),a.a.updatePageMetadata(t)),e.oldSelection)return o.telemetryPageName&&(t.page.name=o.telemetryPageName),a.a.updatePageMetadata(t),void a.a.sendPageView(null,!1)}}class h{reduce(e,t){return{}}}const m={experienceConfigSchema:{}}}}]);